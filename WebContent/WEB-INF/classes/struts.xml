<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC    
	"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN"
    "http://struts.apache.org/dtds/struts-2.3.dtd">
<struts>
    <!-- constant to define dictionary resource bundle -->
    <constant name="struts.custom.i18n.resources" value="global"></constant>
	<constant name="struts.devMode" value="true" />
    <!-- <constant name="struts.action.extension" value=".htm"/> -->
 	<!-- <constant name="struts.enable.DynamicMethodInvocation" value="false" /> -->
    
    <package name="home" extends="struts-default" namespace="/">
    
    	<interceptors>	
			<interceptor name="SessionTimeout" class="com.clostar.interceptors.SignedInTimeout"></interceptor>
		        	
		    <interceptor-stack name="SessionInterceptor">
		    	<interceptor-ref name="SessionTimeout"/>
				<interceptor-ref name="defaultStack" />
			</interceptor-stack>
		</interceptors>
    
		<action name="locale" class="com.clostar.struts.actions.LocaleAction">
			<result name="SUCCESS">home.jsp</result>
		</action>
		
		<action name="home" class="com.clostar.struts.actions.SuperAction" 
		      method="home">
		      <result name="success">home.jsp</result>
		</action>
	
		<action name="sign-up" 
		      class="com.clostar.struts.actions.SignAction" 
		      method="signUp">
		      <result name="error">/sign_up.jsp</result>
		      <result name="input">/sign_up.jsp</result>
		      <result name="success">/signed_up.jsp</result>
		</action>
		<action name="sign-in" 
		      class="com.clostar.struts.actions.SignAction" 
		      method="signIn">
	        <interceptor-ref name="store">
	            <param name="operationMode">RETRIEVE</param>
	        </interceptor-ref>
	        <interceptor-ref name="defaultStack" />
		      <result name="error">/sign_in.jsp</result>
		      <result name="input">/sign_in.jsp</result>
		      <result name="success" type="redirectAction">${targetAction}</result>
		</action>
		<action name="sign-out" 
		      class="com.clostar.struts.actions.SignAction" 
		      method="signOut">
		      <result name="error">/home.jsp</result>
		      <result name="success">/home.jsp</result>
		</action>
		<action name="show_account" 
		      class="com.clostar.struts.actions.UserProfileAction" 
		      method="showAccount">
	        <interceptor-ref name="store">
	            <param name="operationMode">STORE</param>
	        </interceptor-ref>
		      <interceptor-ref name="SessionInterceptor"/>
		      <result name="login">/sign_in.jsp</result>
		      <result name="input">/sign_in.jsp</result>
		      <result name="success">/my_account.jsp</result>
		</action>
		<action name="new_product_details" 
		      class="com.clostar.struts.actions.UserProfileAction" 
		      method="showAccount">
			<interceptor-ref name="SessionInterceptor"/>
			<result name="login">/sign_in.jsp</result>
			<result name="success">/add_product.jsp</result>
		</action>
		<action name="add_product" 
		      class="com.clostar.struts.actions.ProductAction" 
		      method="addProduct">
		    <interceptor-ref name="SessionInterceptor"/>
		    <result name="login">/sign_in.jsp</result>
			<result name="input">/add_product.jsp</result>
		    <result name="success">/my_account.jsp</result>
		</action>
		<action name="add_to_favs" 
		      class="com.clostar.struts.actions.ProductAction" 
		      method="addToFavs">
		    <interceptor-ref name="SessionInterceptor"/>
		    <result name="login">/sign_in.jsp</result>
			<result name="input">/show_product.jsp</result>
		    <result name="success" type="redirectAction">${targetAction}</result>
		</action>
		<action name="list_products" 
		      class="com.clostar.struts.actions.ProductsCriteriaAction" 
		      method="simpleCriteria">
		    <result name="success">/list_products.jsp</result>
		</action>
		<action name="show_product" 
		      class="com.clostar.struts.actions.ProductAction" 
		      method="showProduct">
			<result name="input">/show_product.jsp</result>
		    <result name="success">/show_product.jsp</result>
		</action>
		<action name="add_to_cart" 
		      class="com.clostar.struts.actions.CartAction" 
		      method="addToCart">
		    <interceptor-ref name="SessionInterceptor"/>
		    <result name="login">/sign_in.jsp</result>
			<result name="input" type="redirectAction">
    			<param name="actionName">show_product</param>
    			<param name="id">${id}</param>
    			<param name="name">${name}</param>
    			<param name="name">${price}</param>
    			<param name="name">${currency}</param>
			</result>
		    <result name="success" type="redirectAction">
    			<param name="actionName">show_product</param>
    			<param name="id">${id}</param>
    			<param name="showModal">true</param>
			</result>
		</action>
		<action name="show_cart" 
		      class="com.clostar.struts.actions.CartAction" 
		      method="showCart">
		    <interceptor-ref name="SessionInterceptor"/>
		    <result name="login">/sign_in.jsp</result>
		    <result name="success">/show_cart.jsp</result>
		</action>
		<action name="remove_from_cart" 
		      class="com.clostar.struts.actions.CartAction" 
		      method="removeFromCart">
		    <interceptor-ref name="SessionInterceptor"/>
		    <result name="login">/sign_in.jsp</result>
		    <result name="success">/show_cart.jsp</result>
		</action>
		<action name="prepare_address" 
		      class="com.clostar.struts.actions.CartAction" 
		      method="prepareAddress">
		    <interceptor-ref name="SessionInterceptor"/>
		    <result name="login">/sign_in.jsp</result>
		    <result name="success">/my_cart.jsp</result>
		</action>
   </package>
</struts>